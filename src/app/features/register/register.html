<div class="min-h-screen flex items-center justify-center bg-gray-950 p-4">
  <div class="w-full max-w-md p-8 rounded-2xl bg-gray-900 shadow-xl border border-white/10">
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-yellow-400 mb-2">
        @if (!showOtpInput()) {
          Crear Cuenta
        } @else {
          Verificar C√≥digo
        }
      </h1>
      <p class="text-white/60 text-sm">
        @if (!showOtpInput()) {
          √önete a nuestro sistema de gesti√≥n
        } @else {
          Ingresa el c√≥digo enviado a tu WhatsApp
        }
      </p>
    </div>

    @if (error()) {
      <div class="mb-4 p-4 rounded-lg bg-red-500/10 border border-red-500/30 text-red-300 text-sm">
        <strong>‚ùå Error:</strong> {{ error() }}
      </div>
    }

    @if (successMessage()) {
      <div class="mb-4 p-4 rounded-lg bg-green-500/10 border border-green-500/30 text-green-300 text-sm">
        <strong>‚úÖ</strong> {{ successMessage() }}
      </div>
    }

    @if (debugInfo()) {
      <div class="mb-4 p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 text-blue-300 text-xs">
        <strong>‚ÑπÔ∏è Info:</strong> {{ debugInfo() }}
      </div>
    }

    <!-- Formulario de registro -->
    @if (!showOtpInput()) {
      <form (submit)="submit($event)" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">
            Nombre completo
          </label>
          <input
            [value]="nombre()"
            (input)="onNombreChange($event)"
            type="text"
            required
            placeholder="Tu nombre y apellido"
            class="w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10
                   outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20
                   transition-all">
        </div>

        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">
            Correo electr√≥nico
          </label>
          <input
            [value]="email()"
            (input)="onEmailChange($event)"
            type="email"
            required
            placeholder="tu@email.com"
            class="w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10
                   outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20
                   transition-all">
        </div>

        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">
            Tel√©fono (con c√≥digo de pa√≠s)
          </label>
          <input
            [value]="telefono()"
            (input)="onTelefonoChange($event)"
            type="tel"
            required
            placeholder="5217181043376"
            pattern="[0-9]{10,15}"
            class="w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10
                   outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20
                   transition-all">
          <p class="text-xs text-white/40 mt-1">
            üì± Incluye el c√≥digo de pa√≠s sin espacios ni s√≠mbolos. <br>
            Ejemplo: <span class="text-yellow-400">5217181043376</span> (M√©xico)
          </p>
        </div>

        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">
            Contrase√±a
          </label>
          <input
            [value]="password()"
            (input)="onPasswordChange($event)"
            type="password"
            required
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
            minlength="6"
            class="w-full px-4 py-3 rounded-lg bg-gray-800 text-white border border-white/10
                   outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20
                   transition-all">
          <p class="text-xs text-white/40 mt-1">
            M√≠nimo 6 caracteres
          </p>
        </div>

        <button
          type="submit"
          [disabled]="loading()"
          class="w-full py-3 rounded-xl bg-yellow-400 text-black font-semibold
                 hover:bg-yellow-300 disabled:opacity-50 disabled:cursor-not-allowed
                 transition-colors">
          @if (loading()) {
            <span class="flex items-center justify-center gap-2">
              <span class="animate-spin inline-block w-4 h-4 border-2 border-black border-t-transparent rounded-full"></span>
              Enviando c√≥digo...
            </span>
          } @else {
            <span>Registrarse</span>
          }
        </button>
      </form>
    }

    <!-- Formulario de verificaci√≥n OTP -->
    @if (showOtpInput()) {
      <form (submit)="verifyOtp($event)" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-white/70 mb-2 text-center">
            C√≥digo de verificaci√≥n
          </label>
          <input
            [value]="otpCode()"
            (input)="onOtpChange($event)"
            type="text"
            inputmode="numeric"
            required
            maxlength="6"
            placeholder="000000"
            class="w-full px-4 py-4 rounded-lg bg-gray-800 text-white border border-white/10
                   outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400/20
                   transition-all text-center text-3xl tracking-[0.5em] font-mono"
            autofocus>
          <p class="text-xs text-white/40 mt-2 text-center">
            üì± Revisa tu WhatsApp en el n√∫mero <br>
            <span class="text-yellow-400 font-mono">{{ telefono() }}</span>
          </p>
          <p class="text-xs text-white/50 mt-1 text-center">
            El c√≥digo tiene 6 d√≠gitos y expira en 5 minutos
          </p>
        </div>

        <button
          type="submit"
          [disabled]="verifyingOtp() || otpCode().length !== 6"
          class="w-full py-3 rounded-xl bg-yellow-400 text-black font-semibold
                 hover:bg-yellow-300 disabled:opacity-50 disabled:cursor-not-allowed
                 transition-colors">
          @if (verifyingOtp()) {
            <span class="flex items-center justify-center gap-2">
              <span class="animate-spin inline-block w-4 h-4 border-2 border-black border-t-transparent rounded-full"></span>
              Verificando...
            </span>
          } @else {
            <span>Verificar C√≥digo ({{ otpCode().length }}/6)</span>
          }
        </button>

        <button
          type="button"
          (click)="resendCode()"
          [disabled]="loading()"
          class="w-full py-2 text-sm text-yellow-400 hover:text-yellow-300 
                 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
          <span class="flex items-center justify-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            ¬øNo recibiste el c√≥digo? Reenviar
          </span>
        </button>

        <div class="mt-4 p-3 rounded-lg bg-gray-800/50 border border-white/5">
          <p class="text-xs text-white/50 text-center">
            üí° <strong>Tip:</strong> Si no recibes el c√≥digo, verifica que el tel√©fono sea correcto y est√© en formato internacional.
          </p>
        </div>
      </form>
    }

    <div class="mt-6 text-center text-sm">
      <span class="text-white/40">¬øYa tienes una cuenta?</span>
      <a routerLink="/login" class="ml-1 font-medium text-yellow-400 hover:text-yellow-300 transition-colors">
        Inicia sesi√≥n
      </a>
    </div>
  </div>
</div>
